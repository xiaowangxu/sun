<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Document</title>
</head>

<body>
	<div style="display: flex; flex-direction: column; gap: 20px;">
		<div class="container">
			<input class="inputBox" type="number" value="2021" onchange="year_change(this.value)">
			<input class="inputBox" type="number" value="1" onchange="month_change(this.value)">
			<input class="inputBox" type="number" value="4" onchange="day_change(this.value)">
			<h1>输入日期是：
				<a id="inputText">//</a>
			</h1>
			<h1 style="margin: 0px;">下一个日期是：
				<a id="nextText">//</a>
			</h1>
		</div>
		<div class="container"
			style="display: flex; flex-direction: column; gap: 10px; max-width: 400px; align-self: flex-end;">
			<h2 style="margin: 0px;">有效覆盖</h2>
			<div style="display: flex; flex-direction: row; flex-wrap: wrap; gap: 10px; justify-content: center;">
				<button>2013/12/31</button>
				<button>2013/12/31</button>
				<button>2013/12/31</button>
				<button>2013/12/31</button>
			</div>
			<h2 style="margin: 0px;">无效覆盖</h2>
			<div style="display: flex; flex-direction: row; flex-wrap: wrap; gap: 10px; justify-content: center;">
				<button>2013/12/31</button>
				<button>2013/12/31</button>
				<button>2013/12/31</button>
				<button>2013/12/31</button>
				<button>2013/12/31</button>
				<button>2013/12/31</button>
				<button>2013/12/31</button>
				<button>2013/12/31</button>
				<button>2013/12/31</button>
				<button>2013/12/31</button>
				<button>2013/12/31</button>
				<button>2013/12/31</button>
			</div>
		</div>
	</div>
	<div class="container">
		<table border="1" class="table" cellpadding="10">
			<tr>
				<th>&nbsp;</th>
				<th>有效类</th>
				<th>无效类</th>
			</tr>
			<tr>
				<td>年份</td>
				<td>
					<table class="table">
						<tr>
							<td class="check">1900 <= Year <=2050</td>
						</tr>
					</table>
				</td>
				<td>
					<table class="table">
						<tr>
							<td class="check">Year < 1900</1900>
							</td>
						</tr>
						<tr>
							<td class="check">Year> 2050</1900>
							</td>
						</tr>
					</table>
				</td>
			</tr>
			<tr>
				<td>月份</td>
				<td>
					<table class="table">
						<tr>
							<td class="check">1 <= Month <=12</td>
						</tr>
					</table>
				</td>
				<td>
					<table class="table">
						<tr>
							<td class="check">Month < 1</1900>
							</td>
						</tr>
						<tr>
							<td class="check">Month > 12</1900>
							</td>
						</tr>
					</table>
				</td>
			</tr>
			<tr>
				<td>Year是闰年，2月Date</td>
				<td>
					<table class="table">
						<tr>
							<td class="check">1 <= Date <=29</td>
						</tr>
					</table>
				</td>
				<td>
					<table class="table">
						<tr>
							<td class="check">Date < 1</1900>
							</td>
						</tr>
						<tr>
							<td class="check">Date > 29</1900>
							</td>
						</tr>
					</table>
				</td>
			</tr>
			<tr>
				<td>Year不是闰年，2月Date</td>
				<td>
					<table class="table">
						<tr>
							<td class="check">1 <= Date <=28</td>
						</tr>
					</table>
				</td>
				<td>
					<table class="table">
						<tr>
							<td class="check">Date < 1</1900>
							</td>
						</tr>
						<tr>
							<td class="check">Date > 28</1900>
							</td>
						</tr>
					</table>
				</td>
			</tr>

			<tr>
				<td>1,3,5,7,8,10,12月Date</td>
				<td>
					<table class="table">
						<tr>
							<td class="check">1 <= Date <=31</td>
						</tr>
					</table>
				</td>
				<td>
					<table class="table">
						<tr>
							<td class="check">Date < 1</1900>
							</td>
						</tr>
						<tr>
							<td class="check">Date > 31</1900>
							</td>
						</tr>
					</table>
				</td>
			</tr>

			<tr>
				<td>4,6,9,11月Date</td>
				<td>
					<table class="table">
						<tr>
							<td class="check">1 <= Date <=30</td>
						</tr>
					</table>
				</td>
				<td>
					<table class="table">
						<tr>
							<td class="check">Date < 1</1900>
							</td>
						</tr>
						<tr>
							<td class="check">Date > 30</1900>
							</td>
						</tr>
					</table>
				</td>
			</tr>
		</table>
	</div>
</body>

<style>
	body {
		background-color: rgb(243, 243, 243);
		height: -webkit-fill-available;
		display: flex;
		flex-direction: row;
		align-items: center;
		justify-content: center;
		box-sizing: content-box;
		gap: 20px;
		flex-wrap: wrap;
	}

	.container {
		background-color: white;
		width: auto;
		/* margin: auto; */
		padding: 20px;
		border-radius: 10px;
		box-shadow: 0px 9px 13px 5px #00000030;
	}

	.inputBox {
		background-color: gray;
		outline: none;
		border: none;
		font-size: 34px;
		padding: 8px;
		text-align: center;
		color: white;
		border-radius: 8px;
		width: 150px;
	}

	button {
		outline: none;
		border: none;
		font-size: 30px;
		padding: 8px;
		text-align: center;
		border-radius: 8px;
		width: 180px;
	}

	.table {
		font-size: 30px;
		/* border: solid 2px black; */
	}

	.highlight-yellow {
		background-color: yellow;
		color: black;
	}
</style>

<script>
	var checklist = {
	}

	let myCollection = document.getElementsByTagName('td');

	var iid = 1;

	for (i = 0; i < myCollection.length; i++) {
		let dom = myCollection[i];
		if (dom.className === 'check') {
			let i = iid++;
			dom.innerHTML = '(' + (i) + ') ' + dom.innerHTML
			checklist[i] = { dom: dom, checked: false };
		}
	}

	function reset_CheckList() {
		for (let key in checklist) {
			checklist[key].checked = false;
			checklist[key].dom.classList.remove("highlight-yellow");
		}
	}

	function refresh_CheckList() {
		for (let key in checklist) {
			if (checklist[key].checked)
				checklist[key].dom.classList.add("highlight-yellow");
			else
				checklist[key].dom.classList.remove("highlight-yellow");
		}
	}

	function is_L(y) {
		return (y % 4 === 0 && y % 100 !== 0) || y % 400 === 0;
	}

	function is_VaildDate(y, m, d) {
		if (d < 1) return false;
		const MONTH = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];
		const MONTH_L = [31, 29, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];
		if (is_L(y)) {
			if (d > MONTH_L[m - 1]) return false;
		}
		else {
			if (d > MONTH[m - 1]) return false;
		}
		return true;
	}

	function check(y, m, d) {
		// reset_CheckList();
		let set = new Set();
		function set_Check(id) {
			set.add(id);
			if (checklist[id]) {
				checklist[id].checked = true;
				checklist[id].dom.classList.add("highlight-yellow");
			}
		}
		if (y >= 1900 && y <= 2050) set_Check(1);
		else if (y < 1900) set_Check(2);
		else set_Check(3);
		if (m >= 1 && m <= 12) set_Check(4);
		else if (m < 1) set_Check(5);
		else set_Check(6);
		if (is_L(y)) {
			if (m === 2) {
				if (d >= 1 && d <= 29) set_Check(7);
				else if (d < 1) set_Check(8);
				else set_Check(9);
			}
		}
		else {
			if (m === 2) {
				if (d >= 1 && d <= 28) set_Check(10);
				else if (d < 1) set_Check(11);
				else set_Check(12);
			}
		}
		if ([1, 3, 5, 7, 8, 10, 12].includes(m)) {
			if (d >= 1 && d <= 31) set_Check(13);
			else if (d < 1) set_Check(14);
			else set_Check(15);
		}
		else if ([4, 6, 9, 11].includes(m)) {
			if (d >= 1 && d <= 30) set_Check(16);
			else if (d < 1) set_Check(17);
			else set_Check(18);
		}
		return set;
	}


	// code

	var year = 2021;
	function year_change(val) {
		year = parseInt(val);
		update_InputDate(get_DateStr());
		update_nextDate(get_NextDateNative(year, month, day));
		reset_CheckList();
		check(year, month, day);
	}

	var month = 1;
	function month_change(val) {
		month = parseInt(val);
		update_InputDate(get_DateStr());
		update_nextDate(get_NextDateNative(year, month, day));
		reset_CheckList();
		check(year, month, day);
	}

	var day = 4;
	function day_change(val) {
		day = parseInt(val);
		update_InputDate(get_DateStr());
		update_nextDate(get_NextDateNative(year, month, day));
		reset_CheckList();
		check(year, month, day);
	}

	function get_DateStr() {
		return [year, month, day].join('/');
	}

	function update_InputDate(date) {
		document.querySelector('#inputText').innerHTML = date;
	}

	function update_nextDate(date) {
		document.querySelector('#nextText').innerHTML = date;
	}

	update_InputDate(get_DateStr());
	update_nextDate(get_NextDateNative(year, month, day));

	function get_NextDateStr(y, m, d) {
		return [y, m, d].join('/');
	}

	function get_NextDateNative(y, m, d) {
		let date = new Date(y, m - 1, d);
		date = new Date(+date + 1000 * 60 * 60 * 24);
		return [date.getFullYear(), (date.getMonth() + 1), date.getDate()].join('/')
	}

	// check(year, month, day);

	function check_Random() {
		let y = Math.round(Math.random() * 3000 - 500);
		let m = Math.round(Math.random() * 30 - 10);
		let d = Math.round(Math.random() * 60 - 20);
		let str = check(y, m, d);
		return [([y, m, d].join('/')), str];
	}

	function solve() {
		reset_CheckList();
		let last_sets = new Set();
		function has(set) {
			for (let i of set) {
				if (!last_sets.has(i)) {
					return false;
				}
			}
			return true;
		}
		function filled() {
			for (let key in checklist) {
				if (!checklist[key].checked) return false;
			}
			return true;
		}
		while (!filled()) {
			let [date, ans] = check_Random();
			if (!has(ans)) {
				console.log(date, ans);
				last_sets = new Set([...last_sets, ...ans]);
			}
		}
	}
</script>

</html>